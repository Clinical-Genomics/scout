{% extends 'layouts/scroll-header.html' %}

{% set page_title = 'Cases' %}

{% block toolbar_left %}
  {{ super() }}

  <div class="md-breadcrumb-group flex">
    <div class="md-breadcrumb">
      <small>{{ institute.display_name }}</small>
    </div>
  </div>
{% endblock %}

{% block toolbar_secondary %}
	<div id="search-cases" class="cases-search">
    <div class="cases-search-icon">
      <core-icon icon="search"></core-icon>
    </div>
    <input v-model="casesSearchQuery" type="search" class="cases-search-input">
  </div>
{% endblock %}

{% block content %}
  <div class="cases-list">
    <div class="md-card-list">
      {% for case in cases %}
        <div class="md-card">
          <div class="md-card-body--padded">
            <a href="{{ url_for('core.case', institute_id=institute_id, case_id=case.display_name) }}" class="md-item">
              {% if case.events %}
                <div class="md-item-icon">
                  <div class="dot-indicator"></div>
                </div>
              {% endif %}

              <div class="md-item-label">{{ case.display_name }}</div>

              {% if case.assignee %}
                <div class="tag">{{ case.assignee.first_name }}</div>
              {% endif %}
            </a>

            <div class="md-item-subtitle">
              {% if case.is_research %}
                <a href="{{ url_for('core.variants', institute_id=institute_id, case_id=case.display_name, variant_type='research') }}">Research variants</a>
              {% else %}
                <a href="{{ url_for('core.variants', institute_id=institute_id, case_id=case.display_name, variant_type='clinical', gene_lists=case.default_gene_lists) }}">Clinical variants</a>
              {% endif %}
               |
              <span>{{ case.updated_at|format_date }}</span> |
              <span>{{ case.status }}</span>
              {% if case.is_rerun %}
                | <span class="md-badge--success">RERUN</span>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
{% endblock %}
